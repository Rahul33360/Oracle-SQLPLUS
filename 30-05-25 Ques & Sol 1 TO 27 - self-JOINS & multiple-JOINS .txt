-- Question 1  LIST ENAME, JOB, ANNUAL SAL, DEPTNO, DNAME WHO EARN 30000 PER YEAR AND WHO ARE NOT CLERKS

(EXPLICIT WAY OR ANSI (American National Standards Institute) )

SELECT E.ENAME,E.JOB, E.SAL*12 AS ANNUAL_SAL, D.DEPTNO, D.DNAME
FROM EMP E LEFT JOIN DEPT D	
ON E.DEPTNO = D.DEPTNO 
WHERE E.SAL*12  = 30000 AND E.JOB NOT IN ('CLERK');

		OR

SELECT E.ENAME,E.JOB, E.SAL*12 AS ANNUAL_SAL, D.DEPTNO, D.DNAME
FROM EMP E,DEPT D
WHERE E.DEPTNO = D.DEPTNO AND E.SAL*12 > 30000 AND E.JOB NOT IN ('CLERK');


OUTPUT:

ENAME      JOB       ANNUAL_SAL     DEPTNO DNAME
---------- --------- ---------- ---------- --------------
JONES      MANAGER        35700         20 RESEARCH
BLAKE      MANAGER        34200         30 SALES
SCOTT      ANALYST        36000         20 RESEARCH
KING       PRESIDENT      60000         10 ACCOUNTING
FORD       ANALYST        36000         20 RESEARCH


-- Question 2 LIST THE ALL EMPLOYEES BY NAME AND EMPLOYEE NUMBER ALONG WITH THEIR MANAGER'S NAME AND EMPLOYEE NUMBER


SELECT E1.ENAME,E1.EMPNO,E2.ENAME,E2.EMPNO
FROM EMP E1 LEFT JOIN EMP E2
ON E1.MGR = E2.EMPNO;
 
OUTPUT:


ENAME           EMPNO ENAME           EMPNO
---------- ---------- ---------- ----------
SMITH            7369 FORD             7902
ALLEN            7499 BLAKE            7698
WARD             7521 BLAKE            7698
JONES            7566 KING             7839
MARTIN           7654 BLAKE            7698
BLAKE            7698 KING             7839
CLARK            7782 KING             7839
SCOTT            7788 JONES            7566
KING             7839
TURNER           7844 BLAKE            7698
ADAMS            7876 SCOTT            7788
JAMES            7900 BLAKE            7698
FORD             7902 JONES            7566
MILLER           7934 CLARK            7782

14 rows selected.


-- Question 3 DISPLAY ENAME, DNAME EVEN IF THERE NO EMPLOYEES WORKING IN A PARTICULAR DEPARTMENT.


SELECT D.DNAME,E.ENAME
FROM DEPT D LEFT JOIN EMP E 
ON D.DEPTNO = E.DEPTNO;

		OR
		
SELECT D.DNAME, E.ENAME
FROM DEPT D, EMP E
WHERE D.DEPTNO = E.DEPTNO (+);		


OUTPUT:

DNAME          ENAME
-------------- ----------
ACCOUNTING     CLARK
ACCOUNTING     KING
ACCOUNTING     MILLER
RESEARCH       JONES
RESEARCH       FORD
RESEARCH       ADAMS
RESEARCH       SMITH
RESEARCH       SCOTT
SALES          WARD
SALES          TURNER
SALES          ALLEN
SALES          JAMES
SALES          BLAKE
SALES          MARTIN
OPERATIONS

15 rows selected.


-- Question 4. DISPLAY THE DEPARTMENT NAME ALONG WITH TOTAL SALARY IN EACH DEPARTMENT.


SELECT D.DNAME, SUM(SAL)
FROM DEPT D LEFT JOIN EMP E
ON D.DEPTNO = E.DEPTNO
GROUP BY DNAME;

		OR
		
SELECT D.DNAME, SUM(SAL)
FROM DEPT D,EMP E
WHERE D.DEPTNO = E.DEPTNO (+)
GROUP BY DNAME;		

OUTPUT:


DNAME            SUM(SAL)
-------------- ----------
ACCOUNTING           8750
OPERATIONS
RESEARCH            10875
SALES                9400




-- Question 5.DISPLAY EMPLOYEE NAME AND DEPARTMENT NAME FOR EACH EMPLOYEE.


SELECT E1.ENAME,D.DNAME
FROM EMP E1 LEFT JOIN DEPT D
ON E1.DEPTNO = D.DEPTNO;

		OR

SELECT E1.ENAME,D.DNAME
FROM EMP E1,DEPT D
WHERE E1.DEPTNO = D.DEPTNO (+);	


OUTPUT:


ENAME      DNAME
---------- --------------
SMITH      RESEARCH
ALLEN      SALES
WARD       SALES
JONES      RESEARCH
MARTIN     SALES
BLAKE      SALES
CLARK      ACCOUNTING
SCOTT      RESEARCH
KING       ACCOUNTING
TURNER     SALES
ADAMS      RESEARCH
JAMES      SALES
FORD       RESEARCH
MILLER     ACCOUNTING

14 rows selected.

 
-- Question 6. DISPLAY LOCATION NAME OF THE EMPLOYEE WHO EARN COMMISSION.

SELECT D.LOC
FROM EMP E LEFT JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
WHERE E.COMM IS NOT NULL;

		OR 
		
SELECT D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO (+) AND E.COMM IS NOT NULL;

OUTPUT:

LOC
-------------
CHICAGO
CHICAGO
CHICAGO
CHICAGO


-- Question 7 DISPLAY DEPT NAME OF THE EMPLOYEE WHO EARN MIN SALARY AND HAVE NO REPORTING MANAGER. 

(INNER JOIN)

SELECT D.DNAME
FROM EMP E
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE E.SAL = (SELECT MIN(SAL) FROM EMP WHERE MGR IS NULL)
AND E.MGR IS NULL;

		OR

SELECT D.DNAME
FROM DEPT D 
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE SAL = (SELECT MIN(SAL)
FROM EMP
WHERE MGR IS NULL));


OUTPUT:

DNAME
--------------
ACCOUNTING
 
-- Question 8. DISPLAY DEPT NAME, LOC OF ALL THE EMPLOYEES WHO ARE REPORTING TO SMITH.

(INNER JOIN)
SELECT DISTINCT D.DNAME, D.LOC
FROM EMP E
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE E.MGR = (SELECT EMPNO FROM EMP WHERE ENAME = 'SMITH');

		OR 
		
SELECT DNAME, LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE MGR IN (SELECT EMPNO
FROM EMP
WHERE ENAME = 'SMITH'));

OUTPUT:

no rows selected
 
-- Question 9 LIST ALL THE DEPT NAME AND LOCATION OF ALL THE SALESMAN'S MANAGER'S MANAGER.


SELECT D.DNAME, D.LOC
FROM EMP E1
JOIN EMP E2 ON E1.MGR = E2.EMPNO
JOIN EMP E3 ON E2.MGR = E3.EMPNO
JOIN DEPT D ON E3.DEPTNO = D.DEPTNO
WHERE E1.JOB = 'SALESMAN';

		OR
		
SELECT D.DNAME, D.LOC
FROM EMP E1, EMP E2, EMP E3, DEPT D
WHERE E1.JOB = 'SALESMAN' AND E1.MGR = E2.EMPNO AND E2.MGR = E3.EMPNO AND E3.DEPTNO = D.DEPTNO;

OUTPUT:


DNAME          LOC
-------------- -------------
ACCOUNTING     NEW YORK
ACCOUNTING     NEW YORK
ACCOUNTING     NEW YORK
ACCOUNTING     NEW YORK


-- Question 10 LIST EMPLOYEES WHO ARE WORKING IN RESEARCH DEPT AND THEY ARE MANAGER.

SELECT E.ENAME, E.JOB, D.DNAME
FROM EMP E
JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE D.DNAME = 'RESEARCH' AND E.JOB = 'MANAGER';
 

-- Question 11. DISPLAY THE NUMBER OF EMPLOYEES WHO ARE GETTING SALARY LESS THAN THE BLAKE'S MANAGER.

SELECT COUNT(*)
FROM EMP
WHERE SAL < (SELECT SAL
			FROM EMP
			WHERE EMPNO = (SELECT MGR
					FROM EMP
					WHERE ENAME = 'BLAKE'));

		OR
		
SELECT COUNT(E1.EMPNO)
FROM EMP E1
JOIN EMP BLAKE ON BLAKE.ENAME = 'BLAKE'
JOIN EMP MGR ON BLAKE.MGR = MGR.EMPNO
WHERE E1.SAL < MGR.SAL;

OUTPUT:

COUNT(E1.EMPNO)
---------------
             13


-- Question 12 LIST THE EMPLOYEE DEPTNAME AND LOCATION OF ALL THE EMPLOYEES WHO ARE ANALYST, REPORTING TO BLAKE.
 

SELECT D.DNAME, D.LOC
FROM EMP E
INNER JOIN DEPT D ON E.DEPTNO = D.DEPTNO
WHERE E.JOB = 'ANALYST' 
  AND E.MGR = (SELECT EMPNO 
  FROM EMP 
  WHERE ENAME = 'BLAKE');


OUTPUT:


no rows selected


-- Question 13 DISPLAY THE EMPLOYEE NAMES, HIREDATE, COMM OF FORD'S MANAGER


SELECT ENAME,HIREDATE,COMM
FROM EMP
WHERE EMPNO = (SELECT MGR
FROM EMP
WHERE ENAME = 'FORD');


OUTPUT:

ENAME      HIREDATE        COMM
---------- --------- ----------
JONES      02-APR-81


-- Question 14 DISPLAY ENAME, DNAME OF ALL THE EMPLOYEES WHOSE SALARY LESS THAN AVG SAL OF DEPT 30.

SELECT E.ENAME,D.DNAME
FROM EMP E LEFT JOIN DEPT D 
ON E.DEPTNO in D.DEPTNO
WHERE SAL < ( SELECT AVG(SAL)
FROM EMP
WHERE DEPTNO IN 30);


OUTPUT:

ENAME      DNAME
---------- --------------
SMITH      RESEARCH
WARD       SALES
MARTIN     SALES
TURNER     SALES
ADAMS      RESEARCH
JAMES      SALES
MILLER     ACCOUNTING

7 rows selected.


-- Question 15 DISPLAY ENAME DNAME AND LOC OF ALL THE EMPLOYEES WHO ARE WORKING FOR JONES


SELECT E.ENAME, D.DNAME, D.LOC
FROM EMP E LEFT JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
WHERE MGR = ( SELECT EMPNO
FROM EMP
WHERE ENAME = 'JONES');


OUTPUT:


ENAME      DNAME          LOC
---------- -------------- -------------
SCOTT      RESEARCH       DALLAS
FORD       RESEARCH       DALLAS

-- Question 16 DISPLAY ENAME, DNAME OF ALL THE EMPLOYEES WHOSE NAME STARTS WITH S.


SELECT E.ENAME, D.DNAME
FROM EMP E LEFT JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
WHERE ENAME LIKE 'S%';
 
OUTPUT:

ENAME      DNAME
---------- --------------
SMITH      RESEARCH
SCOTT      RESEARCH


-- Question 17 LIST THE DNAME WHO ARE NOT HAVING ANY EMPLOYEE IN IT


SELECT DNAME
FROM DEPT 
WHERE DEPTNO NOT IN (SELECT DEPTNO
FROM EMP);

		OR 
		
SELECT D.DNAME
FROM DEPT D
LEFT JOIN EMP E ON D.DEPTNO = E.DEPTNO
WHERE E.DEPTNO IS NULL;

OUTPUT:

DNAME
--------------
OPERATIONS


-- Question 18 DISPLAY EMPLOYEE WHO ARE GETTING SAME COMMISSION


SELECT ENAME, COMM
FROM EMP
WHERE COMM IN (
    SELECT COMM
    FROM EMP
    WHERE COMM IS NOT NULL
    GROUP BY COMM
    HAVING COUNT(*) > 1
);


OUTPUT:

no rows selected


-- Question 19. DISPLAY ALL THE DEPT NAMES IRRESPECTIVE OF ANY EMPLOYEE WORKING IN IT OR NOT. IF AN EMPLOYEE IS WORKING DISPLAY HIS NAME.


SELECT D.DNAME,E.ENAME
FROM DEPT D LEFT JOIN EMP E
ON D.DEPTNO = E.DEPTNO;


OUTPUT:


DNAME          ENAME
-------------- ----------
ACCOUNTING     CLARK
ACCOUNTING     KING
ACCOUNTING     MILLER
RESEARCH       JONES
RESEARCH       FORD
RESEARCH       ADAMS
RESEARCH       SMITH
RESEARCH       SCOTT
SALES          WARD
SALES          TURNER
SALES          ALLEN
SALES          JAMES
SALES          BLAKE
SALES          MARTIN
OPERATIONS

15 rows selected.


-- Question 20 WRITE A QUERY TO DISPLAY EMPLOYEE NAME, JOB, DNAME, LOCATION OF ALL EMPLOYEES WHO ARE WORKING AS ACTUAL MANAGERS AND WORKS AT CHICAGO.


SELECT E.ENAME,E.JOB, D.DNAME, D.LOC
FROM EMP E, DEPT D 
WHERE E.JOB = 'MANAGER' AND E.DEPTNO = D.DEPTNO AND D.LOC = 'CHICAGO';


OUTPUT:


ENAME      JOB       DNAME          LOC
---------- --------- -------------- -------------
BLAKE      MANAGER   SALES          CHICAGO



-- Question 21 LIST THE DEPARTMENT NAMES IN WHICH THE EMPLOYEES ARE HIRED BETWEEN 1ST OF JAN 1981 AND 31ST DEC 1982 WITH SALARY MORE THAN 1800.


SELECT D.DNAME
FROM DEPT D, EMP E1
WHERE D.DEPTNO = E1.DEPTNO AND E1.HIREDATE BETWEEN '01-JAN-81' AND '31-DEC-1982' AND E1.SAL > 1800;


OUTPUT:

DNAME
--------------
RESEARCH
SALES
ACCOUNTING
ACCOUNTING
RESEARCH


-- Question 22 DISPLAY 2ND LEAST SALARY FROM EMPLOYEE TABLE.

SELECT MIN(SAL)
FROM EMP
WHERE SAL > (SELECT MIN(SAL)
FROM EMP);

OUTPUT:

 MIN(SAL)
---------
      950


-- Question 23 LIST THE EMPLOYEES WHOSE ANNUAL SALARY IS GREATER THAN 1500 AND WHO ARE JOINED BEFORE 1982 ONLY.


SELECT ENAME, SAL*12 AS ANNUAL_SAL
FROM EMP
WHERE SAL*12 > 1500 AND HIREDATE < '31-DEC-81';


OUTPUT:

ENAME      ANNUAL_SAL
---------- ----------
SMITH            9600
ALLEN           19200
WARD            15000
JONES           35700
MARTIN          15000
BLAKE           34200
CLARK           29400
KING            60000
TURNER          18000
JAMES           11400
FORD            36000

11 rows selected.


-- Question 24 DISPLAY DNAME, LOC, DEPTNO OF EMPLOYEES WHO HAS SAME REPORTING MANAGER

SELECT D.DNAME,D.LOC,D.DEPTNO
FROM DEPT D, EMP E
WHERE D.DEPTNO = E.DEPTNO AND E.MGR IN (SELECT MGR 
FROM EMP
GROUP BY MGR
HAVING COUNT(*) > 1);


OUTPUT:

DNAME          LOC               DEPTNO
-------------- ------------- ----------
ACCOUNTING     NEW YORK              10
SALES          CHICAGO               30
RESEARCH       DALLAS                20
SALES          CHICAGO               30
SALES          CHICAGO               30
SALES          CHICAGO               30
SALES          CHICAGO               30
SALES          CHICAGO               30
RESEARCH       DALLAS                20
RESEARCH       DALLAS                20

10 rows selected.


-- Question 25 DISPLAY EMPLOYEE NAME ALONG WITH THEIR MANAGER NAME.


SELECT E1.ENAME, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.EMPNO;


OUTPUT:

ENAME      ENAME
---------- ----------
SMITH      FORD
ALLEN      BLAKE
WARD       BLAKE
JONES      KING
MARTIN     BLAKE
BLAKE      KING
CLARK      KING
SCOTT      JONES
TURNER     BLAKE
ADAMS      SCOTT
JAMES      BLAKE
FORD       JONES
MILLER     CLARK

13 rows selected.


-- Question 26. DISPLAY EMPLOYEE NAME AND HIS DEPT NAME FOR THE EMPLOYEES WHOSE NAME STARTS WITH 'S'.


SELECT E.ENAME,D.DNAME
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO AND E.ENAME LIKE 'S%';


OUTPUT:

ENAME      DNAME
---------- --------------
SMITH      RESEARCH
SCOTT      RESEARCH


-- Question 27.DISPLAY EMPLOYEES WHO ARE GETTING SAME SALARY.

SELECT ENAME
FROM EMP
WHERE SAL IN (SELECT SAL 
FROM EMP
GROUP BY SAL
HAVING COUNT(*) > 1);

OUTPUT:

ENAME
----------
MARTIN
WAR
FORD
SCOTT
