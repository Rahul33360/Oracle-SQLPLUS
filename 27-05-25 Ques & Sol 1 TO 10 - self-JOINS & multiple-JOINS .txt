-- Question 1
-- 1. WAQTD ENAME, MANAGER'S NAME AND EMPLOYEE'S LOCATION FOR THE EMPLOYEES WORKING AS 'CLERK'.

SELECT E1.ENAME, E2.ENAME,D1.LOC
FROM EMP E1,EMP E2,DEPT D1
WHERE E1.MGR = E2.EMPNO AND E1.DEPTNO = D1.DEPTNO AND E1.JOB ='CLERK';


OUTPUT: --------------

ENAME      ENAME      LOC
---------- ---------- -------------
SMITH      FORD       DALLAS
ADAMS      SCOTT      DALLAS
JAMES      BLAKE      CHICAGO
MILLER     CLARK      NEW YORK


-- Question 2
-- 2. WAQTD ENAME , MANAGER'S SALARY AND MANAGER'S LOCATION IF MANAGER WORKS AS ''PRESIDENT'.

SELECT E1.ENAME, E2.SAL,D2.LOC
FROM EMP E1,EMP E2,DEPT D2
WHERE E1.MGR = E2.EMPNO AND E2.DEPTNO = D2.DEPTNO AND E2.JOB ='PRESIDENT';


OUTPUT: --------------

ENAME             SAL LOC
---------- ---------- -------------
JONES            5000 NEW YORK
BLAKE            5000 NEW YORK
CLARK            5000 NEW YORK


-- Question 3
-- 3. WAQTD ENAME , EMPLOYEE'S SALARY , MANAGER'S NAME , MANAGER'S SALARY ALONG WITH EMPLOYEES DNAME IF EMPLOYEE EARNS MORE THAN MANAGER.


SELECT E1.ENAME,E1.SAL,E2.ENAME,E2.SAL, D1.DNAME
FROM EMP E1, EMP E2, DEPT D1
WHERE E1.MGR = E2.EMPNO AND E1.DEPTNO = D1.DEPTNO AND
E1.SAL > E2.SAL;

OUTPUT: --------------

ENAME             SAL ENAME             SAL DNAME
---------- ---------- ---------- ---------- --------------
SCOTT            3000 JONES            2975 RESEARCH
FORD             3000 JONES            2975 RESEARCH


-- Question 4
-- 4. WAQTD ENAME , SAL MANAGER'S NAME MANAGER'S DNAME IFMANAGER WORKS IN NEW YORK WITH SALARY MORE THAN 3000.

SELECT E1.ENAME,E1.SAL,E2.ENAME,D2.DNAME
FROM EMP E1, EMP E2,DEPT D2
WHERE E1.MGR = E2.EMPNO AND E2.DEPTNO = D2.DEPTNO AND
D2.LOC = 'NEW YORK' AND E2.SAL > 3000;

OUTPUT: --------------

ENAME             SAL ENAME      DNAME
---------- ---------- ---------- --------------
JONES            2975 KING       ACCOUNTING
BLAKE            2850 KING       ACCOUNTING
CLARK            2450 KING       ACCOUNTING


-- Question 5
-- 5. WAQTD ENAME , EMPLOYEE'S DNAME , MANAGER'S NAME MANAGER'SDNAME IF EMP AND MANAGER WORKS IN SAME LOC .

SELECT E1.ENAME,D1.DNAME, E2.ENAME,D2.DNAME
FROM EMP E1, EMP E2, DEPT D1, DEPT D2
WHERE E1.MGR = E2.EMPNO AND D1.LOC = D2.LOC AND E1.DEPTNO = D1.DEPTNO AND E2.DEPTNO = D2.DEPTNO;

OUTPUT: -------------

ENAME      DNAME          ENAME      DNAME
---------- -------------- ---------- --------------
SMITH      RESEARCH       FORD       RESEARCH
ALLEN      SALES          BLAKE      SALES
WARD       SALES          BLAKE      SALES
MARTIN     SALES          BLAKE      SALES
CLARK      ACCOUNTING     KING       ACCOUNTING
SCOTT      RESEARCH       JONES      RESEARCH
TURNER     SALES          BLAKE      SALES
ADAMS      RESEARCH       SCOTT      RESEARCH
JAMES      SALES          BLAKE      SALES
FORD       RESEARCH       JONES      RESEARCH
MILLER     ACCOUNTING     CLARK      ACCOUNTING

11 rows selected.


-- Question 6
-- 6. WAQTD ENAME , EMPLOYEES' HIREDATE , MANAGER'S HIREDATE IF MANAGER WAS HIRED BEFORE THE EMPLOYEE IN TO ACCOUNTING DEPARTMENT .

SELECT E1.ENAME,E1.HIREDATE, E2.HIREDATE
FROM EMP E1, EMP E2, DEPT D2
WHERE E1.MGR = E2.EMPNO AND E2.DEPTNO = D2.DEPTNO AND E2.HIREDATE < E1.HIREDATE AND D2.DNAME = 'ACCOUNTING';

OUTPUT: --------------

ENAME      HIREDATE  HIREDATE
---------- --------- ---------
MILLER     23-JAN-82 09-JUN-81


-- Question 7
-- 7 . WAQTD EMPLOYEE'S NAME , MANAGER'S NAME ALONG WITH , MANAGER'S MANAGER'S NAME .


SELECT E1.ENAME, E2.ENAME,E3.ENAME
FROM EMP E1,EMP E2,EMP E3
WHERE E1.MGR = E2.EMPNO AND E2.MGR = E3.EMPNO;

OUTPUT: --------------

ENAME      ENAME      ENAME
---------- ---------- ----------
SMITH      FORD       JONES
ALLEN      BLAKE      KING
WARD       BLAKE      KING
MARTIN     BLAKE      KING
SCOTT      JONES      KING
TURNER     BLAKE      KING
ADAMS      SCOTT      JONES
JAMES      BLAKE      KING
FORD       JONES      KING
MILLER     CLARK      KING

10 rows selected.

-- Question 8
-- 8. WAQTD ENAME , DNAME , MANAGER'S NAME HIS DEPT NAME IF MANAGER IS HIRED BEFORE 1982 .


SELECT E1.ENAME,D1.DNAME, E2.ENAME,D2.DNAME
FROM EMP E1, EMP E2, DEPT D1, DEPT D2
WHERE E1.MGR = E2.EMPNO AND E1.DEPTNO = D1.DEPTNO AND E2.DEPTNO = D2.DEPTNO AND E2.HIREDATE < '01-JAN-82'; 

OUTPUT: --------------

ENAME      DNAME          ENAME      DNAME
---------- -------------- ---------- --------------
SMITH      RESEARCH       FORD       RESEARCH
ALLEN      SALES          BLAKE      SALES
WARD       SALES          BLAKE      SALES
JONES      RESEARCH       KING       ACCOUNTING
MARTIN     SALES          BLAKE      SALES
BLAKE      SALES          KING       ACCOUNTING
CLARK      ACCOUNTING     KING       ACCOUNTING
SCOTT      RESEARCH       JONES      RESEARCH
TURNER     SALES          BLAKE      SALES
JAMES      SALES          BLAKE      SALES
FORD       RESEARCH       JONES      RESEARCH
MILLER     ACCOUNTING     CLARK      ACCOUNTING

12 rows selected.


-- Question 9
-- 9. WAQTD EMPLOYEE'S NAME WITH DNAME , MANAGER'S NAME WITH LOC ALONG WITH , MANAGER'S MANAGER'S NAME WITH LOC .


SELECT E1.ENAME,D1.DNAME, E2.ENAME,D2.LOC,E3.ENAME,D3.DNAME
FROM EMP E1, EMP E2, EMP E3, DEPT D1, DEPT D2, DEPT D3
WHERE E1.MGR = E2.EMPNO 
AND E2.MGR = E3.EMPNO
AND E1.DEPTNO = D1.DEPTNO 
AND E2.DEPTNO = D2.DEPTNO 
AND E3.DEPTNO = D3.DEPTNO;

OUTPUT: --------------

ENAME      DNAME          ENAME      LOC           ENAME      DNAME
---------- -------------- ---------- ------------- ---------- -----------
SMITH      RESEARCH       FORD       DALLAS        JONES      RESEARCH
ALLEN      SALES          BLAKE      CHICAGO       KING       ACCOUNTING
WARD       SALES          BLAKE      CHICAGO       KING       ACCOUNTING
MARTIN     SALES          BLAKE      CHICAGO       KING       ACCOUNTING
SCOTT      RESEARCH       JONES      DALLAS        KING       ACCOUNTING
TURNER     SALES          BLAKE      CHICAGO       KING       ACCOUNTING
ADAMS      RESEARCH       SCOTT      DALLAS        JONES      RESEARCH
JAMES      SALES          BLAKE      CHICAGO       KING       ACCOUNTING
FORD       RESEARCH       JONES      DALLAS        KING       ACCOUNTING
MILLER     ACCOUNTING     CLARK      NEW YORK      KING       ACCOUNTING

10 rows selected.


-- Question 10
-- 10. WAQTD EMPLOYEE'S NAME WITH DNAME , MANAGER'S SAL WITH DNAME ALONG WITH , MANAGER'S MANAGER'S JOB WITH DNAME IF EMPLOYEE WORKS IN DEPT 10 , MANAGER WORKS AS PRESIDENT OR ACTUAL MANAGER AND MANAGER'S MANAGER SALARY MUST BE GREATER OR EQUAL TO MANAGER'S SALARY.


SELECT E1.ENAME,D1.DNAME, E2.SAL,D2.DNAME,E3.JOB,D3.DNAME
FROM EMP E1, EMP E2, EMP E3, DEPT D1, DEPT D2, DEPT D3
WHERE E1.MGR = E2.EMPNO AND E2.MGR = E3.EMPNO 
AND E1.DEPTNO = D1.DEPTNO 
AND E2.DEPTNO = D2.DEPTNO 
AND E3.DEPTNO = D3.DEPTNO
AND E1.DEPTNO = 10 
AND E2.JOB IN ('PRESIDENT', 'MANAGER') 
AND E3.SAL >= E2.SAL;  


OUTPUT: --------------

ENAME      DNAME                 SAL DNAME          JOB       DNAME
---------- -------------- ------- -------------- --------- -----------
MILLER     ACCOUNTING           2450 ACCOUNTING     PRESIDENT ACCOUNTING

