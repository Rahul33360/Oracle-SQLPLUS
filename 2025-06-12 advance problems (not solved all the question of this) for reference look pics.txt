-- not solved all the problems. for reference look in the photos (for questions)



-- Question 1


CREATE TABLE COLLEGE_STUDENTS
	(STUDENTID NUMBER(3) PRIMARY KEY,
	STUDENTNAME VARCHAR(20) NOT NULL,
	DOB DATE NOT NULL,
	EMAIL VARCHAR(25) NOT NULL UNIQUE,
	MARKS NUMBER(5,2) ,
	PHONENUMBER VARCHAR(15) NOT NULL
	);


	INSERT INTO COLLEGE_STUDENTS (STUDENTID,STUDENTNAME,DOB,EMAIL,MARKS,PHONENUMBER) 
	SELECT 101,'RAHUL KUMAR','01-JAN-2003','rahulkr@gmail.com',100,9876543211
	FROM DUAL
	WHERE NOT EXISTS (SELECT EMAIL
	FROM COLLEGE_STUDENTS
	WHERE EMAIL = 'rahulkr@gmail');

	INSERT INTO COLLEGE_STUDENTS (STUDENTID,STUDENTNAME,DOB,EMAIL,MARKS,PHONENUMBER)
	SELECT '102','SHELBY','01-MAR-2000','SHELBYBROTHERS@GMAIL.COM', 80.5,9876544577
	FROM DUAL
	WHERE NOT EXISTS ( SELECT EMAIL FROM COLLEGE_STUDENTS
	WHERE EMAIL = 'SHELBYBROTHERS@GMAIL.COM');

	INSERT INTO COLLEGE_STUDENTS (STUDENTID,STUDENTNAME,DOB,EMAIL,MARKS,PHONENUMBER) 
	SELECT 103,'Pratik KUMAR','04-JAN-2001','pratikr@gmail.com',75,9933431392
	FROM DUAL
	WHERE NOT EXISTS (SELECT EMAIL
	FROM COLLEGE_STUDENTS
	WHERE EMAIL = 'pratikr@gmail.com');
		
		
	INSERT INTO COLLEGE_STUDENTS (STUDENTID,STUDENTNAME,DOB,EMAIL,MARKS,PHONENUMBER) 
	SELECT 104,'Robert Pattsion','11-JUN-2002','roberpatson@gmail.com',47,9319384977
	FROM DUAL
	WHERE NOT EXISTS (SELECT EMAIL
	FROM COLLEGE_STUDENTS
	WHERE EMAIL = 'roberpatson@gmail.com');
		
	


-- Question 2


UPDATE COLLEGE_STUDENTS
SET MARKS = MARKS + MARKS*10/100
WHERE PHONENUMBER LIKE '%77' AND DOB = '01-JAN-2000';

-- OUTPUT:


 STUDENTID STUDENTNAME     DOB       EMAIL                          MARKS PHONENUMBE
---------- --------------- --------- ------------------------- ---------- ----------
       101 RAHUL           01-JAN-03 RAHULKR@GMAIL.COM               99.5 6200190064
       102 SHELBY          01-JAN-00 SHELBYBROTHERS@GMAIL.COM       88.55 9876544577
       103 SPIDERMAN       04-JAN-01 SPIDEY@GMAIL.COM                  66 9824352341
       104 JON SNOW        22-DEC-03 JONSNOW@GMAIL.COM                 89 9898674592


SQL> UPDATE COLLEGE_STUDENTS
  2  SET MARKS = MARKS + MARKS*10/100
  3  WHERE PHONENUMBER LIKE '%77' AND DOB = '01-JAN-2000';

1 row updated.

SQL> select * from college_students;

 STUDENTID STUDENTNAME     DOB       EMAIL                          MARKS PHONENUMBE
---------- --------------- --------- ------------------------- ---------- ----------
       101 RAHUL           01-JAN-03 RAHULKR@GMAIL.COM               99.5 6200190064
       102 SHELBY          01-JAN-00 SHELBYBROTHERS@GMAIL.COM       97.41 9876544577
       103 SPIDERMAN       04-JAN-01 SPIDEY@GMAIL.COM                  66 9824352341
       104 JON SNOW        22-DEC-03 JONSNOW@GMAIL.COM                 89 9898674592



-- Question 3

DELETE
FROM COLLEGE_STUDENTS
WHERE MARKS < (SELECT AVG(MARKS) 
FROM COLLEGE_STUDENTS);


1 rows deleted.


SQL> select * from college_students;

 STUDENTID STUDENTNAME     DOB       EMAIL                          MARKS PHONENUMBE
---------- --------------- --------- ------------------------- ---------- ----------
       101 RAHUL           01-JAN-03 RAHULKR@GMAIL.COM               99.5 6200190064
       102 SHELBY          01-JAN-00 SHELBYBROTHERS@GMAIL.COM       97.41 9876544577
       104 JON SNOW        22-DEC-03 JONSNOW@GMAIL.COM                 89 9898674592



-- Question 4

INSERT INTO MEMBERS (MEMBERID, NAME, AGE, JOINDATE, ASSIGNEDTRAINERID)
SELECT 113, 'RAHUL', 21, TO_DATE('31-JAN-2003', 'DD-MON-YYYY'),
(
    SELECT TRAINERID
    FROM (
        SELECT T.TRAINERID, COUNT(M.MEMBERID) AS CNT
        FROM TRAINERS T
        LEFT JOIN MEMBERS M ON T.TRAINERID = M.ASSIGNEDTRAINERID
        GROUP BY T.TRAINERID
        ORDER BY COUNT(M.MEMBERID)
    )
    WHERE ROWNUM = 1
)
FROM DUAL;








---------------------------------------------------------------------------------
Same code for above one (but these are not working just kept for reference here Question 4 this may be wrong in logic)



INSERT INTO MEMBERS (MEMBERID,NAME,AGE,JOINDATE,ASSIGNEDTRAINERID) 
SELECT '111','SURESH',30,'31-DEC-1998',
(SELECT ASSIGNEDTRAINERID
FROM MEMBERS
GROUP BY ASSIGNEDTRAINERID
HAVING COUNT(*) IN (SELECT MIN(COUNT(*))
					FROM MEMBERS
					GROUP BY ASSIGNEDTRAINERID)
)
from dual;


--- DOUBT BOTH ABOVE ONE AND THIS BELOW ONE ARE FOR SAME 

INSERT INTO MEMBERS (MEMBERID, NAME, AGE, JOINDATE, ASSIGNEDTRAINERID)
SELECT 113, 'RAHUL', 21, '22-JAN-2003', 
(
    SELECT TRAINERID
    FROM TRAINERS
    WHERE TRAINERID IN ( 
        SELECT ASSIGNEDTRAINERID
        FROM MEMBERS
        GROUP BY ASSIGNEDTRAINERID
        HAVING COUNT(*) = ( 
            SELECT MIN(COUNT(*))
            FROM MEMBERS
            GROUP BY ASSIGNEDTRAINERID
        )
    ) 
)
FROM DUAL;



INSERT INTO MEMBERS (MEMBERID,NAME,AGE,JOINDATE,ASSIGNEDTRAINERID)
SELECT 112,'RAHUL',21,'31-JAN-2003', (SELECT ASSIGNEDTRAINERID 
									  FROM MEMBERS
									  GROUP BY ASSIGNEDTRAINERID
									  HAVING COUNT(*) IN (SELECT MIN(COUNT(*))
														  FROM MEMBER
														  GROUP BY ASSIGNEDTRAINERID)
)
FROM DUAL;